<!-- saved from url=(0014)about:internet -->
<pre class="code">
<span class="srcline"><span class="lineno"><a href="98,1" id="srcline1"> 1</a></span><span class="line"><span class="keyword">function</span> [<span class="var type1" id="S2T6U3">bSp</span>, <span class="var type1" id="S3T110U4">rmm</span>, <span class="var type1" id="S4T106U5">cmm</span>] = twoPointMaxMarginSplit(<span class="var type1" id="S5T52U8">X</span>,<span class="var type1" id="S6T1U9">Y</span>,<span class="var type1" id="S7T4U10">tol</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="98,2" id="srcline2"> 2</a></span><span class="line"><span class="comment">% This should only be done if X has exactly 2 unique rows in which case it</span></span></span>
<span class="srcline"><span class="lineno"><a href="98,3" id="srcline3"> 3</a></span><span class="line"><span class="comment">% produces the optimal split</span></span></span>
<span class="srcline"><span class="lineno"><a href="98,4" id="srcline4"> 4</a></span><span class="line"><span class="mxinfo" id="T45:U7"><span class="var type1" id="S8T45U13">bType1</span> = <span class="mxinfo" id="T45:U9">all(<span class="mxinfo" id="T60:U10"><span class="mxinfo" id="T52:U11">abs(<span class="mxinfo" id="T52:U12">bsxfun(@minus,<span class="var type1" id="S5T52U23">X</span>,<span class="mxinfo" id="T51:U14"><span class="var type1" id="S5T52U25">X</span>(<span class="mxinfo" id="T4:U16">1</span>,:)</span>)</span>)</span>&lt;<span class="var type1" id="S7T4U28">tol</span></span>,2)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="98,5" id="srcline5"> 5</a></span><span class="line"><span class="keyword">if</span> <span class="mxinfo" id="T6:U18"><span class="mxinfo" id="T4:U19">size(<span class="var type1" id="S6T1U35">Y</span>,2)</span>==<span class="mxinfo" id="T4:U21">1</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="98,6" id="srcline6"> 6</a></span><span class="line">    <span class="mxinfo" id="T1:U22"><span class="var type1" id="S14T1U40">YLeft</span> = <span class="var type1" id="S6T1U41">Y</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="98,7" id="srcline7"> 7</a></span><span class="line">    <span class="mxinfo" id="T1:U25"><span class="var type1" id="S15T1U44">YRight</span> = <span class="mxinfo" id="T111:U27">~<span class="var type1" id="S6T1U46">Y</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="98,8" id="srcline8"> 8</a></span><span class="line"><span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="98,9" id="srcline9"> 9</a></span><span class="line">    <span class="mxinfo" id="T1:U29"><span class="var type1" id="S14T1U50">YLeft</span> = <span class="mxinfo" id="T1:U31"><span class="var type1" id="S6T1U52">Y</span>(<span class="var type1" id="S8T45U53">bType1</span>,:)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="98,10" id="srcline10">10</a></span><span class="line">    <span class="mxinfo" id="T1:U34"><span class="var type1" id="S15T1U57">YRight</span> = <span class="mxinfo" id="T1:U36"><span class="var type1" id="S6T1U59">Y</span>(<span class="mxinfo" id="T45:U38">~<span class="var type1" id="S8T45U61">bType1</span></span>,:)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="98,11" id="srcline11">11</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="98,12" id="srcline12">12</a></span><span class="line"><span class="keyword">if</span> <span class="mxinfo" id="T6:U40">all(<span class="mxinfo" id="T108:U41"><span class="mxinfo" id="T51:U42">sum(<span class="var type1" id="S14T1U70">YLeft</span>,1)</span>==<span class="mxinfo" id="T51:U44">sum(<span class="var type1" id="S15T1U74">YRight</span>,1)</span></span>)</span></span></span>
<span class="srcline"><span class="lineno"><a href="98,13" id="srcline13">13</a></span><span class="line">    <span class="comment">% Here the two unique points have identical sets of class</span></span></span>
<span class="srcline"><span class="lineno"><a href="98,14" id="srcline14">14</a></span><span class="line">    <span class="comment">% labels and so we can't split</span></span></span>
<span class="srcline"><span class="lineno"><a href="98,15" id="srcline15">15</a></span><span class="line">    <span class="mxinfo" id="T6:U46"><span class="var type1" id="S2T6U78">bSp</span> = <span class="mxinfo" id="T6:U48">false</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="98,16" id="srcline16">16</a></span><span class="line">    <span class="mxinfo" id="T110:U49"><span class="var type1" id="S3T110U83">rmm</span> = <span class="mxinfo" id="T70:U51">[]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="98,17" id="srcline17">17</a></span><span class="line">    <span class="mxinfo" id="T106:U52"><span class="var type1" id="S4T106U88">cmm</span> = <span class="mxinfo" id="T70:U54">[]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="98,18" id="srcline18">18</a></span><span class="line">    <span class="keyword">return</span></span></span>
<span class="srcline"><span class="lineno"><a href="98,19" id="srcline19">19</a></span><span class="line"><span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="98,20" id="srcline20">20</a></span><span class="line">    <span class="mxinfo" id="T6:U55"><span class="var type1" id="S2T6U95">bSp</span> = <span class="mxinfo" id="T6:U57">true</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="98,21" id="srcline21">21</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="98,22" id="srcline22">22</a></span><span class="line"><span class="comment">% Otherwise the optimal spliting plane is the plane perpendicular</span></span></span>
<span class="srcline"><span class="lineno"><a href="98,23" id="srcline23">23</a></span><span class="line"><span class="comment">% to the vector between the two points (rmm) and the maximal</span></span></span>
<span class="srcline"><span class="lineno"><a href="98,24" id="srcline24">24</a></span><span class="line"><span class="comment">% marginal split point (cmm) is halway between the two points on</span></span></span>
<span class="srcline"><span class="lineno"><a href="98,25" id="srcline25">25</a></span><span class="line"><span class="comment">% this line.</span></span></span>
<span class="srcline"><span class="lineno"><a href="98,26" id="srcline26">26</a></span><span class="line"><span class="mxinfo" id="T104:U58"><span class="var type1" id="S19T104U100">iType2</span> = <span class="mxinfo" id="T104:U60">find(<span class="mxinfo" id="T45:U61">~<span class="var type1" id="S8T45U104">bType1</span></span>,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="98,27" id="srcline27">27</a></span><span class="line"><span class="mxinfo" id="T110:U63"><span class="var type1" id="S3T110U108">rmm</span> = <span class="mxinfo" id="T46:U65">(<span class="mxinfo" id="T51:U66"><span class="mxinfo" id="T138:U67"><span class="var type1" id="S5T52U113">X</span>(<span class="var type1" id="S19T104U114">iType2</span>,:)</span>-<span class="mxinfo" id="T51:U70"><span class="var type1" id="S5T52U117">X</span>(<span class="mxinfo" id="T4:U72">1</span>,:)</span></span>)'</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="98,28" id="srcline28">28</a></span><span class="line"><span class="mxinfo" id="T106:U73"><span class="var type1" id="S4T106U122">cmm</span> = <span class="mxinfo" id="T112:U75"><span class="mxinfo" id="T4:U76">0.5</span>*(<span class="mxinfo" id="T112:U77"><span class="mxinfo" id="T52:U78"><span class="mxinfo" id="T138:U79"><span class="var type1" id="S5T52U129">X</span>(<span class="var type1" id="S19T104U130">iType2</span>,:)</span>*<span class="var type1" id="S3T110U132">rmm</span></span>+<span class="mxinfo" id="T112:U83"><span class="mxinfo" id="T51:U84"><span class="var type1" id="S5T52U135">X</span>(<span class="mxinfo" id="T4:U86">1</span>,:)</span>*<span class="var type1" id="S3T110U138">rmm</span></span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="98,29" id="srcline29">29</a></span><span class="line"><span class="keyword">if</span> <span class="mxinfo" id="T6:U88">any(<span class="mxinfo" id="T117:U89">isnan(<span class="mxinfo" id="T113:U90"><span class="var type1" id="S4T106U147">cmm</span>(:)</span>)</span>)</span> || <span class="mxinfo" id="T6:U92">any(<span class="mxinfo" id="T117:U93">isinf(<span class="mxinfo" id="T113:U94"><span class="var type1" id="S4T106U154">cmm</span>(:)</span>)</span>)</span></span></span>
<span class="srcline"><span class="lineno"><a href="98,30" id="srcline30">30</a></span><span class="line">    error(<span class="string">'Suggested split point at infitity / nan'</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="98,31" id="srcline31">31</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="98,32" id="srcline32">32</a></span><span class="line"><span class="keyword">end</span></span></span>
</pre>
