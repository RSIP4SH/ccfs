<!-- saved from url=(0014)about:internet -->
<pre class="code">
<span class="srcline"><span class="lineno"><a href="181,1" id="srcline1">  1</a></span><span class="line"><span class="keyword">function</span> [<span class="var type1" id="S2T6U3">bLeaf</span>, <span class="var type1" id="S3T107U4">bLessThanTrain</span>, <span class="var type1" id="S4T108U5">partitionPoint</span>, <span class="var type1" id="S5T46U6">projMat</span>, <span class="var type1" id="S6T109U7">countsNode</span>, <span class="var type1" id="S7T51U8">iIn</span>] = expandNode(<span class="var type1" id="S8T52U11">XTrain</span>,<span class="var type1" id="S9T1U12">YTrain</span>,<span class="var type1" id="S10T55U13">options</span>,<span class="var type1" id="S11T51U14">iFeatureNum</span>,<span class="var type1" id="S12T4U15">depth</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="181,2" id="srcline2">  2</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="181,3" id="srcline3">  3</a></span><span class="line"><span class="mxinfo" id="T107:U12"><span class="var type1" id="S3T107U18">bLessThanTrain</span> = <span class="mxinfo" id="T66:U14"><span class="mxinfo" id="T6:U15">false</span>(<span class="mxinfo" id="T4:U16">0</span>,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="181,4" id="srcline4">  4</a></span><span class="line"><span class="mxinfo" id="T108:U17"><span class="var type1" id="S4T108U25">partitionPoint</span> = <span class="mxinfo" id="T4:U19">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="181,5" id="srcline5">  5</a></span><span class="line"><span class="mxinfo" id="T46:U20"><span class="var type1" id="S5T46U29">projMat</span> = <span class="mxinfo" id="T38:U22">zeros(<span class="mxinfo" id="T4:U23">0</span>,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="181,6" id="srcline6">  6</a></span><span class="line"><span class="mxinfo" id="T51:U24"><span class="var type1" id="S7T51U36">iIn</span> = <span class="mxinfo" id="T35:U26">zeros(<span class="mxinfo" id="T4:U27">1</span>,<span class="mxinfo" id="T4:U28">0</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="181,7" id="srcline7">  7</a></span><span class="line"><span class="keyword">if</span> <span class="mxinfo" id="T6:U29"><span class="mxinfo" id="T4:U30">size(<span class="var type1" id="S9T1U46">YTrain</span>,2)</span>==<span class="mxinfo" id="T4:U32">1</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="181,8" id="srcline8">  8</a></span><span class="line">    <span class="mxinfo" id="T109:U33"><span class="var type1" id="S6T109U51">countsNode</span> = <span class="mxinfo" id="T147:U35">[<span class="mxinfo" id="T114:U36"><span class="mxinfo" id="T4:U37">numel(<span class="var type1" id="S9T1U57">YTrain</span>)</span>-<span class="mxinfo" id="T114:U39">sum(<span class="var type1" id="S9T1U60">YTrain</span>)</span></span>,<span class="mxinfo" id="T114:U41">sum(<span class="var type1" id="S9T1U63">YTrain</span>)</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="181,9" id="srcline9">  9</a></span><span class="line"><span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="181,10" id="srcline10"> 10</a></span><span class="line">    <span class="mxinfo" id="T109:U43"><span class="var type1" id="S6T109U67">countsNode</span> = <span class="mxinfo" id="T51:U45">sum(<span class="var type1" id="S9T1U70">YTrain</span>,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="181,11" id="srcline11"> 11</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="181,12" id="srcline12"> 12</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="181,13" id="srcline13"> 13</a></span><span class="line"><span class="mxinfo" id="T4:U47"><span class="var type1" id="S18T4U74">N</span> = <span class="mxinfo" id="T4:U49">size(<span class="var type1" id="S8T52U77">XTrain</span>,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="181,14" id="srcline14"> 14</a></span><span class="line"><span class="comment">% Return if one training point, pure node or if options for returning</span></span></span>
<span class="srcline"><span class="lineno"><a href="181,15" id="srcline15"> 15</a></span><span class="line"><span class="comment">% fulfilled.  A little case to deal with a binary YTrain is required.</span></span></span>
<span class="srcline"><span class="lineno"><a href="181,16" id="srcline16"> 16</a></span><span class="line"><span class="mxinfo" id="T6:U51"><span class="var type1" id="S2T6U81">bLeaf</span> = <span class="mxinfo" id="T6:U53">(<span class="mxinfo" id="T6:U54"><span class="var type1" id="S18T4U85">N</span>&lt;(<span class="mxinfo" id="T4:U56">max(<span class="mxinfo" id="T4:U57">2</span>,<span class="mxinfo" id="T4:U58"><span class="var type1" id="S10T55U91">options</span>.minPointsForSplit</span>)</span>)</span>) || <span class="mxinfo" id="T6:U60"><span class="var type1" id="S12T4U94">depth</span>&gt;<span class="mxinfo" id="T4:U62"><span class="var type1" id="S10T55U96">options</span>.maxDepthSplit</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="181,17" id="srcline17"> 17</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="181,18" id="srcline18"> 18</a></span><span class="line"><span class="keyword">if</span> <span class="mxinfo" id="T6:U64">~<span class="var type1" id="S2T6U101">bLeaf</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="181,19" id="srcline19"> 19</a></span><span class="line">    <span class="keyword">if</span> <span class="mxinfo" id="T6:U66"><span class="mxinfo" id="T4:U67">size(<span class="var type1" id="S9T1U107">YTrain</span>,2)</span>&gt;<span class="mxinfo" id="T4:U69">1</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="181,20" id="srcline20"> 20</a></span><span class="line">        <span class="mxinfo" id="T6:U70"><span class="var type1" id="S2T6U112">bLeaf</span> = (<span class="mxinfo" id="T6:U72"><span class="mxinfo" id="T4:U73">sum(<span class="mxinfo" id="T110:U74"><span class="mxinfo" id="T109:U75">abs(<span class="mxinfo" id="T51:U76">sum(<span class="var type1" id="S9T1U122">YTrain</span>,1)</span>)</span>&gt;<span class="mxinfo" id="T4:U78">1e-12</span></span>)</span>&lt;<span class="mxinfo" id="T4:U79">2</span></span>)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="181,21" id="srcline21"> 21</a></span><span class="line">    <span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="181,22" id="srcline22"> 22</a></span><span class="line">        <span class="mxinfo" id="T6:U80"><span class="var type1" id="S2T6U129">bLeaf</span> = <span class="mxinfo" id="T6:U82">any(<span class="mxinfo" id="T75:U83">bsxfun(@eq,<span class="mxinfo" id="T4:U84">sum(<span class="mxinfo" id="T45:U85"><span class="var type1" id="S9T1U139">YTrain</span>(:)</span>)</span>,<span class="mxinfo" id="T16:U87">[<span class="mxinfo" id="T4:U88">0</span>,<span class="mxinfo" id="T4:U89">size(<span class="var type1" id="S9T1U146">YTrain</span>,1)</span>]</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="181,23" id="srcline23"> 23</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="181,24" id="srcline24"> 24</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="181,25" id="srcline25"> 25</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="181,26" id="srcline26"> 26</a></span><span class="line"><span class="keyword">if</span> <span class="var type1" id="S2T6U150">bLeaf</span></span></span>
<span class="srcline"><span class="lineno"><a href="181,27" id="srcline27"> 27</a></span><span class="line">    <span class="keyword">return</span></span></span>
<span class="srcline"><span class="lineno"><a href="181,28" id="srcline28"> 28</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="181,29" id="srcline29"> 29</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="181,30" id="srcline30"> 30</a></span><span class="line"><span class="comment">%% Subsample features as required for hyperplane sampling</span></span></span>
<span class="srcline"><span class="lineno"><a href="181,31" id="srcline31"> 31</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="181,32" id="srcline32"> 32</a></span><span class="line"><span class="mxinfo" id="T35:U92"><span class="var type1" id="S7T35U154">iIn</span> = <span class="mxinfo" id="T35:U94">zeros(<span class="mxinfo" id="T4:U95">1</span>,<span class="mxinfo" id="T4:U96">0</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="181,33" id="srcline33"> 33</a></span><span class="line"><span class="mxinfo" id="T70:U97"><span class="var type1" id="S24T70U161">XTrainBag</span> = <span class="mxinfo" id="T70:U99">zeros(<span class="mxinfo" id="T4:U100">0</span>,<span class="mxinfo" id="T4:U101">0</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="181,34" id="srcline34"> 34</a></span><span class="line"><span class="mxinfo" id="T70:U102"><span class="var type1" id="S25T70U168">YTrainBag</span> = <span class="mxinfo" id="T70:U104">zeros(<span class="mxinfo" id="T4:U105">0</span>,<span class="mxinfo" id="T4:U106">0</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="181,35" id="srcline35"> 35</a></span><span class="line"><span class="mxinfo" id="T51:U107"><span class="var type1" id="S26T51U175">iCanBeSelected</span> = <span class="mxinfo" id="T51:U109"><span class="fcn" id="F289N4:B177">fastUnique</span>(<span class="var type1" id="S11T51U178">iFeatureNum</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="181,36" id="srcline36"> 36</a></span><span class="line"><span class="mxinfo" id="T51:U111"><span class="var type1" id="S26T51U182">iCanBeSelected</span>(<span class="mxinfo" id="T73:U113">isnan(<span class="var type1" id="S26T51U185">iCanBeSelected</span>)</span>)=[]</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="181,37" id="srcline37"> 37</a></span><span class="line"><span class="mxinfo" id="T4:U115"><span class="var type1" id="S29T4U190">lambda</span> = <span class="mxinfo" id="T4:U117">min(<span class="mxinfo" id="T4:U118">numel(<span class="var type1" id="S26T51U195">iCanBeSelected</span>)</span>,<span class="mxinfo" id="T4:U120"><span class="var type1" id="S10T55U197">options</span>.lambda</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="181,38" id="srcline38"> 38</a></span><span class="line"><span class="mxinfo" id="T51:U122"><span class="var type1" id="S31T51U201">indFeatIn</span> = <span class="mxinfo" id="T51:U124">randperm(<span class="mxinfo" id="T4:U125">numel(<span class="var type1" id="S26T51U206">iCanBeSelected</span>)</span>,<span class="var type1" id="S29T4U207">lambda</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="181,39" id="srcline39"> 39</a></span><span class="line"><span class="mxinfo" id="T51:U128"><span class="var type1" id="S33T51U210">iFeatIn</span> = <span class="mxinfo" id="T51:U130"><span class="var type1" id="S26T51U212">iCanBeSelected</span>(<span class="var type1" id="S31T51U213">indFeatIn</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="181,40" id="srcline40"> 40</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="181,41" id="srcline41"> 41</a></span><span class="line"><span class="mxinfo" id="T60:U133"><span class="var type1" id="S34T60U216">bInMat</span> = <span class="mxinfo" id="T60:U135">bsxfun(@eq,<span class="mxinfo" id="T51:U136"><span class="mxinfo" id="T46:U137"><span class="var type1" id="S11T51U223">iFeatureNum</span>(:)</span>'</span>,<span class="mxinfo" id="T46:U139">sort(<span class="mxinfo" id="T46:U140"><span class="var type1" id="S33T51U228">iFeatIn</span>(:)</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="181,42" id="srcline42"> 42</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="181,43" id="srcline43"> 43</a></span><span class="line"><span class="mxinfo" id="T51:U142"><span class="var type1" id="S7T51U232">iIn</span> = <span class="mxinfo" id="T51:U144">find(<span class="mxinfo" id="T73:U145">any(<span class="var type1" id="S34T60U237">bInMat</span>,1)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="181,44" id="srcline44"> 44</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="181,45" id="srcline45"> 45</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="181,46" id="srcline46"> 46</a></span><span class="line"><span class="comment">% Check for variation along selected dimensions and resample features that</span></span></span>
<span class="srcline"><span class="lineno"><a href="181,47" id="srcline47"> 47</a></span><span class="line"><span class="comment">% have no variation</span></span></span>
<span class="srcline"><span class="lineno"><a href="181,48" id="srcline48"> 48</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="181,49" id="srcline49"> 49</a></span><span class="line"><span class="mxinfo" id="T73:U147"><span class="var type1" id="S37T73U241">bXVaries</span> = <span class="mxinfo" id="T73:U149"><span class="fcn" id="F344N9:B243">queryIfColumnsVary</span>(<span class="mxinfo" id="T52:U150"><span class="var type1" id="S8T52U245">XTrain</span>(:,<span class="var type1" id="S7T51U247">iIn</span>)</span>,<span class="mxinfo" id="T4:U153"><span class="var type1" id="S10T55U249">options</span>.XVariationTol</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="181,50" id="srcline50"> 50</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="181,51" id="srcline51"> 51</a></span><span class="line"><span class="keyword">if</span> <span class="mxinfo" id="T6:U155">~<span class="mxinfo" id="T6:U156">all(<span class="var type1" id="S37T73U256">bXVaries</span>)</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="181,52" id="srcline52"> 52</a></span><span class="line">    <span class="mxinfo" id="T51:U158"><span class="var type1" id="S40T51U259">iInNew</span> = <span class="var type1" id="S7T51U260">iIn</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="181,53" id="srcline53"> 53</a></span><span class="line">    <span class="mxinfo" id="T4:U161"><span class="var type1" id="S41T4U263">nSelected</span> = <span class="mxinfo" id="T4:U163">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="181,54" id="srcline54"> 54</a></span><span class="line">    <span class="mxinfo" id="T51:U164"><span class="var type1" id="S7T51U267">iIn</span> = <span class="mxinfo" id="T51:U166"><span class="var type1" id="S7T51U269">iIn</span>(<span class="var type1" id="S37T73U270">bXVaries</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="181,55" id="srcline55"> 55</a></span><span class="line">    <span class="keyword">while</span> <span class="mxinfo" id="T6:U169">~<span class="mxinfo" id="T6:U170">all(<span class="var type1" id="S37T73U276">bXVaries</span>)</span></span> &amp;&amp; <span class="mxinfo" id="T6:U172"><span class="var type1" id="S29T4U278">lambda</span>&gt;<span class="mxinfo" id="T4:U174">0</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="181,56" id="srcline56"> 56</a></span><span class="line">        <span class="mxinfo" id="T51:U175"><span class="mxinfo" id="T51:U176"><span class="var type1" id="S11T51U283">iFeatureNum</span>(<span class="mxinfo" id="T51:U178"><span class="var type1" id="S40T51U285">iInNew</span>(<span class="mxinfo" id="T73:U180">~<span class="var type1" id="S37T73U287">bXVaries</span></span>)</span>)</span> = <span class="mxinfo" id="T4:U182">NaN</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="181,57" id="srcline57"> 57</a></span><span class="line">        <span class="mxinfo" id="T60:U183"><span class="mxinfo" id="T60:U184"><span class="var type1" id="S34T60U293">bInMat</span>(:,<span class="mxinfo" id="T51:U186"><span class="var type1" id="S40T51U296">iInNew</span>(<span class="mxinfo" id="T73:U188">~<span class="var type1" id="S37T73U298">bXVaries</span></span>)</span>)</span> = <span class="mxinfo" id="T6:U190">false</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="181,58" id="srcline58"> 58</a></span><span class="line">        <span class="mxinfo" id="T45:U191"><span class="var type1" id="S43T45U303">bRemainsSelected</span> = <span class="mxinfo" id="T45:U193">any(<span class="var type1" id="S34T60U306">bInMat</span>,2)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="181,59" id="srcline59"> 59</a></span><span class="line">        <span class="mxinfo" id="T4:U195"><span class="var type1" id="S41T4U310">nSelected</span> = <span class="mxinfo" id="T4:U197"><span class="var type1" id="S41T4U312">nSelected</span>+<span class="mxinfo" id="T4:U199">sum(<span class="var type1" id="S43T45U315">bRemainsSelected</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="181,60" id="srcline60"> 60</a></span><span class="line">        <span class="mxinfo" id="T51:U201"><span class="var type1" id="S26T51U319">iCanBeSelected</span>(<span class="var type1" id="S31T51U320">indFeatIn</span>) = []</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="181,61" id="srcline61"> 61</a></span><span class="line">        <span class="mxinfo" id="T4:U204"><span class="var type1" id="S29T4U325">lambda</span> = <span class="mxinfo" id="T4:U206">min(<span class="mxinfo" id="T4:U207">numel(<span class="var type1" id="S26T51U330">iCanBeSelected</span>)</span>,<span class="mxinfo" id="T4:U209"><span class="var type1" id="S29T4U332">lambda</span>-<span class="var type1" id="S41T4U333">nSelected</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="181,62" id="srcline62"> 62</a></span><span class="line">        <span class="keyword">if</span> <span class="mxinfo" id="T6:U212"><span class="var type1" id="S29T4U337">lambda</span>&lt;<span class="mxinfo" id="T4:U214">1</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="181,63" id="srcline63"> 63</a></span><span class="line">            <span class="keyword">break</span></span></span>
<span class="srcline"><span class="lineno"><a href="181,64" id="srcline64"> 64</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="181,65" id="srcline65"> 65</a></span><span class="line">        <span class="mxinfo" id="T51:U215"><span class="var type1" id="S31T51U342">indFeatIn</span> = <span class="mxinfo" id="T51:U217">randperm(<span class="mxinfo" id="T4:U218">numel(<span class="var type1" id="S26T51U347">iCanBeSelected</span>)</span>,<span class="var type1" id="S29T4U348">lambda</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="181,66" id="srcline66"> 66</a></span><span class="line">        <span class="mxinfo" id="T51:U221"><span class="var type1" id="S33T51U351">iFeatIn</span> = <span class="mxinfo" id="T51:U223"><span class="var type1" id="S26T51U353">iCanBeSelected</span>(<span class="var type1" id="S31T51U354">indFeatIn</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="181,67" id="srcline67"> 67</a></span><span class="line">        <span class="mxinfo" id="T60:U226"><span class="var type1" id="S34T60U357">bInMat</span> = <span class="mxinfo" id="T60:U228">bsxfun(@eq,<span class="mxinfo" id="T51:U229"><span class="mxinfo" id="T46:U230"><span class="var type1" id="S11T51U364">iFeatureNum</span>(:)</span>'</span>,<span class="mxinfo" id="T46:U232"><span class="var type1" id="S33T51U367">iFeatIn</span>(:)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="181,68" id="srcline68"> 68</a></span><span class="line">        <span class="mxinfo" id="T51:U234"><span class="var type1" id="S40T51U371">iInNew</span> = <span class="mxinfo" id="T51:U236">find(<span class="mxinfo" id="T73:U237">any(<span class="var type1" id="S34T60U376">bInMat</span>,1)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="181,69" id="srcline69"> 69</a></span><span class="line">        <span class="mxinfo" id="T73:U239"><span class="var type1" id="S37T73U380">bXVaries</span> = <span class="mxinfo" id="T73:U241"><span class="fcn" id="F344N9:B382">queryIfColumnsVary</span>(<span class="mxinfo" id="T52:U242"><span class="var type1" id="S8T52U384">XTrain</span>(:,<span class="var type1" id="S40T51U386">iInNew</span>)</span>,<span class="mxinfo" id="T4:U245"><span class="var type1" id="S10T55U388">options</span>.XVariationTol</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="181,70" id="srcline70"> 70</a></span><span class="line">        <span class="mxinfo" id="T51:U247"><span class="var type1" id="S7T51U392">iIn</span> = <span class="mxinfo" id="T51:U249">sort(<span class="mxinfo" id="T51:U250">[<span class="var type1" id="S7T51U397">iIn</span>,<span class="mxinfo" id="T51:U252"><span class="var type1" id="S40T51U399">iInNew</span>(<span class="var type1" id="S37T73U400">bXVaries</span>)</span>]</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="181,71" id="srcline71"> 71</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="181,72" id="srcline72"> 72</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="181,73" id="srcline73"> 73</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="181,74" id="srcline74"> 74</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="181,75" id="srcline75"> 75</a></span><span class="line"><span class="mxinfo" id="T51:U255"><span class="var type1" id="S7T51U403">iIn</span> = <span class="mxinfo" id="T51:U257"><span class="fcn" id="F366N11:B405">randomSubspace</span>(<span class="var type1" id="S11T51U406">iFeatureNum</span>,<span class="mxinfo" id="T4:U259"><span class="var type1" id="S10T55U408">options</span>.lambda</span>,<span class="mxinfo" id="T4:U261"><span class="var type1" id="S10T55U411">options</span>.XVariationTol</span>,<span class="var type1" id="S8T52U413">XTrain</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="181,76" id="srcline76"> 76</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="181,77" id="srcline77"> 77</a></span><span class="line"><span class="keyword">if</span> <span class="mxinfo" id="T6:U264">isempty(<span class="var type1" id="S7T51U418">iIn</span>)</span></span></span>
<span class="srcline"><span class="lineno"><a href="181,78" id="srcline78"> 78</a></span><span class="line">    <span class="comment">% This means that there was no variation along any feature, therefore</span></span></span>
<span class="srcline"><span class="lineno"><a href="181,79" id="srcline79"> 79</a></span><span class="line">    <span class="comment">% exit.</span></span></span>
<span class="srcline"><span class="lineno"><a href="181,80" id="srcline80"> 80</a></span><span class="line">    <span class="mxinfo" id="T6:U266"><span class="var type1" id="S2T6U421">bLeaf</span> = <span class="mxinfo" id="T6:U268">true</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="181,81" id="srcline81"> 81</a></span><span class="line">    <span class="keyword">return</span></span></span>
<span class="srcline"><span class="lineno"><a href="181,82" id="srcline82"> 82</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="181,83" id="srcline83"> 83</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="181,84" id="srcline84"> 84</a></span><span class="line"><span class="comment">%% Projection bootstrap if required</span></span></span>
<span class="srcline"><span class="lineno"><a href="181,85" id="srcline85"> 85</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="181,86" id="srcline86"> 86</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="181,87" id="srcline87"> 87</a></span><span class="line"><span class="keyword">if</span> <span class="mxinfo" id="T6:U269"><span class="var type1" id="S10T55U428">options</span>.bProjBoot</span></span></span>
<span class="srcline"><span class="lineno"><a href="181,88" id="srcline88"> 88</a></span><span class="line">    <span class="mxinfo" id="T46:U271"><span class="var type1" id="S47T46U432">iTrainThis</span> = <span class="mxinfo" id="T46:U273">randi(<span class="mxinfo" id="T4:U274">size(<span class="var type1" id="S8T52U437">XTrain</span>,1)</span>,<span class="mxinfo" id="T4:U276">size(<span class="var type1" id="S8T52U441">XTrain</span>,1)</span>,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="181,89" id="srcline89"> 89</a></span><span class="line">    <span class="mxinfo" id="T52:U278"><span class="var type1" id="S24T52U446">XTrainBag</span> = <span class="mxinfo" id="T52:U280"><span class="var type1" id="S8T52U448">XTrain</span>(<span class="var type1" id="S47T46U449">iTrainThis</span>,<span class="var type1" id="S7T51U450">iIn</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="181,90" id="srcline90"> 90</a></span><span class="line">    <span class="mxinfo" id="T60:U284"><span class="var type1" id="S25T60U453">YTrainBag</span> = <span class="mxinfo" id="T1:U286"><span class="var type1" id="S9T1U455">YTrain</span>(<span class="var type1" id="S47T46U456">iTrainThis</span>,:)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="181,91" id="srcline91"> 91</a></span><span class="line"><span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="181,92" id="srcline92"> 92</a></span><span class="line">    <span class="mxinfo" id="T52:U289"><span class="var type1" id="S24T52U461">XTrainBag</span> = <span class="mxinfo" id="T52:U291"><span class="var type1" id="S8T52U463">XTrain</span>(:,<span class="var type1" id="S7T51U465">iIn</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="181,93" id="srcline93"> 93</a></span><span class="line">    <span class="mxinfo" id="T60:U294"><span class="var type1" id="S25T60U468">YTrainBag</span> = <span class="var type1" id="S9T1U469">YTrain</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="181,94" id="srcline94"> 94</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="181,95" id="srcline95"> 95</a></span><span class="line"><span class="mxinfo" id="T73:U297"><span class="var type1" id="S49T73U472">bXBagVaries</span> = <span class="mxinfo" id="T73:U299"><span class="fcn" id="F344N9:B474">queryIfColumnsVary</span>(<span class="var type1" id="S24T52U475">XTrainBag</span>,<span class="mxinfo" id="T4:U301"><span class="var type1" id="S10T55U477">options</span>.XVariationTol</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="181,96" id="srcline96"> 96</a></span><span class="line"><span class="keyword">if</span> <span class="mxinfo" id="T6:U303">~<span class="mxinfo" id="T6:U304">any(<span class="var type1" id="S49T73U486">bXBagVaries</span>)</span></span> || (<span class="mxinfo" id="T6:U306"><span class="mxinfo" id="T4:U307">size(<span class="var type1" id="S25T60U492">YTrainBag</span>,2)</span>&gt;<span class="mxinfo" id="T4:U309">1</span></span> &amp;&amp; (<span class="mxinfo" id="T6:U310"><span class="mxinfo" id="T4:U311">sum(<span class="mxinfo" id="T110:U312"><span class="mxinfo" id="T109:U313">abs(<span class="mxinfo" id="T51:U314">sum(<span class="var type1" id="S25T60U504">YTrainBag</span>,1)</span>)</span>&gt;<span class="mxinfo" id="T4:U316">1e-12</span></span>)</span>&lt;<span class="mxinfo" id="T4:U317">2</span></span>)) || (<span class="mxinfo" id="T6:U318"><span class="mxinfo" id="T4:U319">size(<span class="var type1" id="S25T60U513">YTrainBag</span>,2)</span>==<span class="mxinfo" id="T4:U321">1</span></span> &amp;&amp; <span class="mxinfo" id="T6:U322">any(<span class="mxinfo" id="T75:U323">bsxfun(@eq,<span class="mxinfo" id="T4:U324">sum(<span class="mxinfo" id="T45:U325"><span class="var type1" id="S25T60U525">YTrainBag</span>(:)</span>)</span>,<span class="mxinfo" id="T16:U327">[<span class="mxinfo" id="T4:U328">0</span>,<span class="mxinfo" id="T4:U329">size(<span class="var type1" id="S25T60U532">YTrainBag</span>,1)</span>]</span>)</span>)</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="181,97" id="srcline97"> 97</a></span><span class="line">    <span class="keyword">if</span> <span class="mxinfo" id="T6:U331">~<span class="mxinfo" id="T6:U332"><span class="var type1" id="S10T55U538">options</span>.bContinueProjBootDegenerate</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="181,98" id="srcline98"> 98</a></span><span class="line">        <span class="mxinfo" id="T6:U334"><span class="var type1" id="S2T6U542">bLeaf</span> = <span class="mxinfo" id="T6:U336">true</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="181,99" id="srcline99"> 99</a></span><span class="line">        <span class="keyword">return</span></span></span>
<span class="srcline"><span class="lineno"><a href="181,100" id="srcline100">100</a></span><span class="line">    <span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="181,101" id="srcline101">101</a></span><span class="line">        <span class="mxinfo" id="T52:U337"><span class="var type1" id="S24T52U549">XTrainBag</span> = <span class="mxinfo" id="T52:U339"><span class="var type1" id="S8T52U551">XTrain</span>(:,<span class="var type1" id="S7T51U553">iIn</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="181,102" id="srcline102">102</a></span><span class="line">        <span class="mxinfo" id="T60:U342"><span class="var type1" id="S25T60U556">YTrainBag</span> = <span class="var type1" id="S9T1U557">YTrain</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="181,103" id="srcline103">103</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="181,104" id="srcline104">104</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="181,105" id="srcline105">105</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="181,106" id="srcline106">106</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="181,107" id="srcline107">107</a></span><span class="line"><span class="keyword">if</span> ~isempty(<span class="var type1" id="S10T67U565">options</span>.projections) &amp;&amp; ((<span class="mxinfo" id="T6:U346"><span class="mxinfo" id="T4:U347">size(<span class="var type1" id="S24T52U573">XTrainBag</span>,1)</span>==<span class="mxinfo" id="T4:U349">2</span></span>) || <span class="mxinfo" id="T6:U350"><span class="fcn" id="F383N10:B577">queryIfOnlyTwoUniqueRows</span>(<span class="var type1" id="S24T52U578">XTrainBag</span>)</span>) <span class="comment">% Check for only having two points</span></span></span>
<span class="srcline"><span class="lineno"><a href="181,108" id="srcline108">108</a></span><span class="line">    <span class="comment">% If there are only two points setup a maximum marginal split between the points</span></span></span>
<span class="srcline"><span class="lineno"><a href="181,109" id="srcline109">109</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="181,110" id="srcline110">110</a></span><span class="line">    <span class="mxinfo" id="T6:U352">[<span class="var type1" id="S51T6U582">bSplit</span>,<span class="var type1" id="S5T112U583">projMat</span>,<span class="var type1" id="S4T108U584">partitionPoint</span>] = <span class="fcn" id="F434N13:B586">twoPointMaxMarginSplit</span>(<span class="var type1" id="S24T52U587">XTrainBag</span>,<span class="var type1" id="S25T60U588">YTrainBag</span>,<span class="mxinfo" id="T4:U358"><span class="var type1" id="S10T55U590">options</span>.XVariationTol</span>)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="181,111" id="srcline111">111</a></span><span class="line">    <span class="keyword">if</span> <span class="mxinfo" id="T6:U360">~<span class="var type1" id="S51T6U595">bSplit</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="181,112" id="srcline112">112</a></span><span class="line">        <span class="mxinfo" id="T6:U362"><span class="var type1" id="S2T6U598">bLeaf</span> = <span class="mxinfo" id="T6:U364">true</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="181,113" id="srcline113">113</a></span><span class="line">    <span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="181,114" id="srcline114">114</a></span><span class="line">        <span class="mxinfo" id="T107:U365"><span class="var type1" id="S3T107U604">bLessThanTrain</span> = <span class="mxinfo" id="T148:U367">(<span class="mxinfo" id="T52:U368"><span class="mxinfo" id="T52:U369"><span class="var type1" id="S8T52U609">XTrain</span>(:,<span class="var type1" id="S7T51U611">iIn</span>)</span>*<span class="var type1" id="S5T52U612">projMat</span></span>)&lt;=<span class="var type1" id="S4T108U613">partitionPoint</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="181,115" id="srcline115">115</a></span><span class="line">        <span class="mxinfo" id="T4:U374"><span class="var type1" id="S53T4U616">iDir</span> = <span class="mxinfo" id="T4:U376">1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="181,116" id="srcline116">116</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="181,117" id="srcline117">117</a></span><span class="line"><span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="181,118" id="srcline118">118</a></span><span class="line">    <span class="comment">%[projMat, partitionPoint, bLessThanTrain, bLeaf] = getProjAndPartPoint(XTrainBag,XTrain,YTrain,iIn,options.includeOriginalAxes,options.XVariationTol,options.splitCriterion,options.dirIfEqual,options.epsilonCCA);</span></span></span>
<span class="srcline"><span class="lineno"><a href="181,119" id="srcline119">119</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="181,120" id="srcline120">120</a></span><span class="line">    <span class="comment">% Generate the new features as required</span></span></span>
<span class="srcline"><span class="lineno"><a href="181,121" id="srcline121">121</a></span><span class="line">    <span class="comment">%projMat = componentAnalysisForCompiling(XTrainBag,XTrainBag,options.epsilonCCA);</span></span></span>
<span class="srcline"><span class="lineno"><a href="181,122" id="srcline122">122</a></span><span class="line">    <span class="mxinfo" id="T73:U377"><span class="var type1" id="S54T73U621">bYpresent</span> = <span class="mxinfo" id="T73:U379">any(<span class="var type1" id="S25T60U624">YTrainBag</span>,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="181,123" id="srcline123">123</a></span><span class="line">    <span class="mxinfo" id="T60:U381"><span class="var type1" id="S25T60U628">YTrainBag</span> = <span class="mxinfo" id="T60:U383"><span class="var type1" id="S25T60U630">YTrainBag</span>(:,<span class="var type1" id="S54T73U632">bYpresent</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="181,124" id="srcline124">124</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="181,125" id="srcline125">125</a></span><span class="line">    <span class="mxinfo" id="T51:U386"><span class="var type1" id="S55T51U635">muX</span> = <span class="mxinfo" id="T51:U388"><span class="mxinfo" id="T51:U389">sum(<span class="var type1" id="S24T52U639">XTrainBag</span>,1)</span>/<span class="mxinfo" id="T4:U391">size(<span class="var type1" id="S24T52U643">XTrainBag</span>,1)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="181,126" id="srcline126">126</a></span><span class="line">    <span class="mxinfo" id="T51:U393"><span class="var type1" id="S56T51U647">muY</span> = <span class="mxinfo" id="T51:U395"><span class="mxinfo" id="T51:U396">sum(<span class="var type1" id="S25T60U651">YTrainBag</span>,1)</span>/<span class="mxinfo" id="T4:U398">size(<span class="var type1" id="S25T60U655">YTrainBag</span>,1)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="181,127" id="srcline127">127</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="181,128" id="srcline128">128</a></span><span class="line">    <span class="comment">% Subtraction of the mean is common to the process of calculating the</span></span></span>
<span class="srcline"><span class="lineno"><a href="181,129" id="srcline129">129</a></span><span class="line">    <span class="comment">% projection matrices for both CCA and PCA but for computational</span></span></span>
<span class="srcline"><span class="lineno"><a href="181,130" id="srcline130">130</a></span><span class="line">    <span class="comment">% effificently we don't make this translation when actually applying the</span></span></span>
<span class="srcline"><span class="lineno"><a href="181,131" id="srcline131">131</a></span><span class="line">    <span class="comment">% projections</span></span></span>
<span class="srcline"><span class="lineno"><a href="181,132" id="srcline132">132</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="181,133" id="srcline133">133</a></span><span class="line">    <span class="mxinfo" id="T52:U400"><span class="var type1" id="S24T52U659">XTrainBag</span> = <span class="mxinfo" id="T52:U402">bsxfun(@minus,<span class="var type1" id="S24T52U664">XTrainBag</span>,<span class="var type1" id="S55T51U665">muX</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="181,134" id="srcline134">134</a></span><span class="line">    <span class="mxinfo" id="T52:U405"><span class="var type1" id="S25T52U668">YTrainBag</span> = <span class="mxinfo" id="T52:U407">bsxfun(@minus,<span class="var type1" id="S25T60U673">YTrainBag</span>,<span class="var type1" id="S56T51U674">muY</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="181,135" id="srcline135">135</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="181,136" id="srcline136">136</a></span><span class="line">    <span class="mxinfo" id="T4:U410">[<span class="var type1" id="S58T4U678">x1</span>,<span class="var type1" id="S59T4U679">x2</span>] = size(<span class="var type1" id="S24T52U682">XTrainBag</span>)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="181,137" id="srcline137">137</a></span><span class="line">    <span class="keyword">if</span> <span class="mxinfo" id="T6:U414"><span class="mxinfo" id="T4:U415">size(<span class="var type1" id="S25T52U688">YTrainBag</span>,1)</span> ~= <span class="var type1" id="S58T4U690">x1</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="181,138" id="srcline138">138</a></span><span class="line">        error(<span class="string">'Input sizes do not match'</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="181,139" id="srcline139">139</a></span><span class="line">    <span class="keyword">elseif</span> <span class="mxinfo" id="T6:U418"><span class="var type1" id="S58T4U697">x1</span> == <span class="mxinfo" id="T4:U420">1</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="181,140" id="srcline140">140</a></span><span class="line">        error(<span class="string">'Cannot carry out component analysis with only one point'</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="181,141" id="srcline141">141</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="181,142" id="srcline142">142</a></span><span class="line">    <span class="mxinfo" id="T4:U421"><span class="var type1" id="S61T4U705">K</span> = <span class="mxinfo" id="T4:U423">size(<span class="var type1" id="S25T52U708">YTrainBag</span>,2)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="181,143" id="srcline143">143</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="181,144" id="srcline144">144</a></span><span class="line">    <span class="comment">% This code is a reduction of the function canoncorr.  This</span></span></span>
<span class="srcline"><span class="lineno"><a href="181,145" id="srcline145">145</a></span><span class="line">    <span class="comment">% method is explained in the supplementary material</span></span></span>
<span class="srcline"><span class="lineno"><a href="181,146" id="srcline146">146</a></span><span class="line">    <span class="mxinfo" id="T52:U425">[<span class="var type1" id="S62T52U713">q1</span>,<span class="var type1" id="S63T52U714">r1</span>,<span class="var type1" id="S64T51U715">p1</span>] = qr(<span class="var type1" id="S24T52U718">XTrainBag</span>,0)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="181,147" id="srcline147">147</a></span><span class="line">    <span class="comment">% Reduce to full rank within some tolerance</span></span></span>
<span class="srcline"><span class="lineno"><a href="181,148" id="srcline148">148</a></span><span class="line">    <span class="mxinfo" id="T4:U430"><span class="var type1" id="S66T4U722">rankX</span> = <span class="mxinfo" id="T4:U432">sum(<span class="mxinfo" id="T45:U433"><span class="mxinfo" id="T46:U434">abs(<span class="mxinfo" id="T46:U435">diag(<span class="var type1" id="S63T52U730">r1</span>)</span>)</span> &gt;= (<span class="mxinfo" id="T4:U437"><span class="mxinfo" id="T4:U438"><span class="var type1" id="S10T55U734">options</span>.epsilonCCA</span>*<span class="mxinfo" id="T4:U440">abs(<span class="mxinfo" id="T4:U441"><span class="var type1" id="S63T52U739">r1</span>(<span class="mxinfo" id="T4:U443">1</span>)</span>)</span></span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="181,149" id="srcline149">149</a></span><span class="line">    <span class="keyword">if</span> <span class="mxinfo" id="T6:U444"><span class="var type1" id="S66T4U744">rankX</span> == <span class="mxinfo" id="T4:U446">0</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="181,150" id="srcline150">150</a></span><span class="line">        <span class="comment">%warning('X doesnt vary so component analysis fails');</span></span></span>
<span class="srcline"><span class="lineno"><a href="181,151" id="srcline151">151</a></span><span class="line">        <span class="mxinfo" id="T46:U447"><span class="var type1" id="S5T46U748">projMat</span> = <span class="mxinfo" id="T46:U449">[<span class="mxinfo" id="T4:U450">1</span>;<span class="mxinfo" id="T46:U451">zeros(<span class="mxinfo" id="T4:U452"><span class="mxinfo" id="T4:U453">size(<span class="var type1" id="S24T52U758">XTrainBag</span>,2)</span>-<span class="mxinfo" id="T4:U455">1</span></span>,1)</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="181,152" id="srcline152">152</a></span><span class="line">        <span class="keyword">return</span></span></span>
<span class="srcline"><span class="lineno"><a href="181,153" id="srcline153">153</a></span><span class="line">    <span class="keyword">elseif</span> <span class="mxinfo" id="T6:U456"><span class="var type1" id="S66T4U765">rankX</span> &lt; <span class="var type1" id="S59T4U766">x2</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="181,154" id="srcline154">154</a></span><span class="line">        <span class="mxinfo" id="T52:U459"><span class="var type1" id="S62T52U769">q1</span> = <span class="mxinfo" id="T149:U461"><span class="var type1" id="S62T52U771">q1</span>(:,<span class="mxinfo" id="T6:U463"><span class="mxinfo" id="T4:U464">1</span>:<span class="var type1" id="S66T4U775">rankX</span></span>)</span></span>; <span class="mxinfo" id="T52:U466"><span class="var type1" id="S63T52U778">r1</span> = <span class="mxinfo" id="T52:U468"><span class="var type1" id="S63T52U780">r1</span>(<span class="mxinfo" id="T6:U470"><span class="mxinfo" id="T4:U471">1</span>:<span class="var type1" id="S66T4U783">rankX</span></span>,<span class="mxinfo" id="T6:U473"><span class="mxinfo" id="T4:U474">1</span>:<span class="var type1" id="S66T4U786">rankX</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="181,155" id="srcline155">155</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="181,156" id="srcline156">156</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="181,157" id="srcline157">157</a></span><span class="line">    <span class="comment">% This code is a reduction of the function canoncorr.  This</span></span></span>
<span class="srcline"><span class="lineno"><a href="181,158" id="srcline158">158</a></span><span class="line">    <span class="comment">% method is explained in the supplementary material</span></span></span>
<span class="srcline"><span class="lineno"><a href="181,159" id="srcline159">159</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="181,160" id="srcline160">160</a></span><span class="line">    <span class="mxinfo" id="T52:U476">[<span class="var type1" id="S68T52U790">q2</span>,<span class="var type1" id="S69T52U791">r2</span>,<span class="mxinfo" id="T4:U479"><span class="mxinfo" id="T4:U480">~</span></span>] = qr(<span class="var type1" id="S25T52U795">YTrainBag</span>,0)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="181,161" id="srcline161">161</a></span><span class="line">    <span class="comment">% Reduce to full rank within some tolerance</span></span></span>
<span class="srcline"><span class="lineno"><a href="181,162" id="srcline162">162</a></span><span class="line">    <span class="mxinfo" id="T4:U482"><span class="var type1" id="S70T4U799">rankY</span> = <span class="mxinfo" id="T4:U484">sum(<span class="mxinfo" id="T45:U485"><span class="mxinfo" id="T46:U486">abs(<span class="mxinfo" id="T46:U487">diag(<span class="var type1" id="S69T52U807">r2</span>)</span>)</span> &gt;= (<span class="mxinfo" id="T4:U489"><span class="mxinfo" id="T4:U490"><span class="var type1" id="S10T55U811">options</span>.epsilonCCA</span>*<span class="mxinfo" id="T4:U492">abs(<span class="mxinfo" id="T4:U493"><span class="var type1" id="S69T52U816">r2</span>(<span class="mxinfo" id="T4:U495">1</span>)</span>)</span></span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="181,163" id="srcline163">163</a></span><span class="line">    <span class="keyword">if</span> <span class="mxinfo" id="T6:U496"><span class="var type1" id="S70T4U821">rankY</span> == <span class="mxinfo" id="T4:U498">0</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="181,164" id="srcline164">164</a></span><span class="line">        <span class="comment">%warning('Y doesnt vary so component analysis fails');</span></span></span>
<span class="srcline"><span class="lineno"><a href="181,165" id="srcline165">165</a></span><span class="line">        <span class="mxinfo" id="T46:U499"><span class="var type1" id="S5T46U825">projMat</span> = <span class="mxinfo" id="T46:U501">[<span class="mxinfo" id="T4:U502">1</span>;<span class="mxinfo" id="T46:U503">zeros(<span class="mxinfo" id="T4:U504"><span class="mxinfo" id="T4:U505">size(<span class="var type1" id="S24T52U835">XTrainBag</span>,2)</span>-<span class="mxinfo" id="T4:U507">1</span></span>,1)</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="181,166" id="srcline166">166</a></span><span class="line">        <span class="keyword">return</span></span></span>
<span class="srcline"><span class="lineno"><a href="181,167" id="srcline167">167</a></span><span class="line">    <span class="keyword">elseif</span> <span class="mxinfo" id="T6:U508"><span class="var type1" id="S70T4U842">rankY</span> &lt; <span class="var type1" id="S61T4U843">K</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="181,168" id="srcline168">168</a></span><span class="line">        <span class="mxinfo" id="T52:U511"><span class="var type1" id="S68T52U846">q2</span> = <span class="mxinfo" id="T149:U513"><span class="var type1" id="S68T52U848">q2</span>(:,<span class="mxinfo" id="T6:U515"><span class="mxinfo" id="T4:U516">1</span>:<span class="var type1" id="S70T4U852">rankY</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="181,169" id="srcline169">169</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="181,170" id="srcline170">170</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="181,171" id="srcline171">171</a></span><span class="line">    <span class="comment">% Solve CCA using the decompositions</span></span></span>
<span class="srcline"><span class="lineno"><a href="181,172" id="srcline172">172</a></span><span class="line">    <span class="mxinfo" id="T4:U518"><span class="var type1" id="S71T4U855">d</span> = <span class="mxinfo" id="T4:U520">min(<span class="var type1" id="S66T4U858">rankX</span>,<span class="var type1" id="S70T4U859">rankY</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="181,173" id="srcline173">173</a></span><span class="line">    <span class="mxinfo" id="T52:U523">[<span class="var type1" id="S72T52U863">L</span>,<span class="mxinfo" id="T4:U525"><span class="mxinfo" id="T4:U526">~</span></span>,<span class="mxinfo" id="T4:U527"><span class="mxinfo" id="T4:U528">~</span></span>] = svd(<span class="mxinfo" id="T52:U529"><span class="mxinfo" id="T52:U530"><span class="var type1" id="S62T52U870">q1</span>'</span> * <span class="var type1" id="S68T52U871">q2</span></span>,0)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="181,174" id="srcline174">174</a></span><span class="line">    <span class="mxinfo" id="T52:U533"><span class="var type1" id="S5T52U875">projMat</span> = <span class="mxinfo" id="T52:U535"><span class="mxinfo" id="T52:U536"><span class="var type1" id="S63T52U878">r1</span> \ <span class="mxinfo" id="T52:U538"><span class="var type1" id="S72T52U880">L</span>(:,<span class="mxinfo" id="T6:U540"><span class="mxinfo" id="T4:U541">1</span>:<span class="var type1" id="S71T4U884">d</span></span>)</span></span> * <span class="mxinfo" id="T4:U543">sqrt(<span class="mxinfo" id="T4:U544"><span class="var type1" id="S58T4U888">x1</span>-<span class="mxinfo" id="T4:U546">1</span></span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="181,175" id="srcline175">175</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="181,176" id="srcline176">176</a></span><span class="line">    <span class="comment">% Put coefficients back to their full size and their correct order</span></span></span>
<span class="srcline"><span class="lineno"><a href="181,177" id="srcline177">177</a></span><span class="line">    <span class="mxinfo" id="T52:U547"><span class="mxinfo" id="T52:U548"><span class="var type1" id="S5T52U893">projMat</span>(<span class="var type1" id="S64T51U894">p1</span>,:)</span> = <span class="mxinfo" id="T52:U551">[<span class="var type1" id="S5T52U898">projMat</span>; <span class="mxinfo" id="T120:U553">zeros(<span class="mxinfo" id="T4:U554"><span class="var type1" id="S59T4U903">x2</span>-<span class="var type1" id="S66T4U904">rankX</span></span>,<span class="var type1" id="S71T4U905">d</span>)</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="181,178" id="srcline178">178</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="181,179" id="srcline179">179</a></span><span class="line">    <span class="comment">% Normalize the projection matrices.  This ensures that the later tests for</span></span></span>
<span class="srcline"><span class="lineno"><a href="181,180" id="srcline180">180</a></span><span class="line">    <span class="comment">% close points are triggered appropriately and is useful for</span></span></span>
<span class="srcline"><span class="lineno"><a href="181,181" id="srcline181">181</a></span><span class="line">    <span class="comment">% interpretability.</span></span></span>
<span class="srcline"><span class="lineno"><a href="181,182" id="srcline182">182</a></span><span class="line">    <span class="mxinfo" id="T52:U558"><span class="var type1" id="S5T52U908">projMat</span> = <span class="mxinfo" id="T52:U560">bsxfun(@rdivide,<span class="var type1" id="S5T52U913">projMat</span>,<span class="mxinfo" id="T51:U562">sqrt(<span class="mxinfo" id="T51:U563">sum(<span class="mxinfo" id="T52:U564"><span class="var type1" id="S5T52U919">projMat</span>.^2</span>,1)</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="181,183" id="srcline183">183</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="181,184" id="srcline184">184</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="181,185" id="srcline185">185</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="181,186" id="srcline186">186</a></span><span class="line">    <span class="comment">%% Choose the features to use</span></span></span>
<span class="srcline"><span class="lineno"><a href="181,187" id="srcline187">187</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="181,188" id="srcline188">188</a></span><span class="line">    <span class="keyword">if</span> <span class="mxinfo" id="T6:U566"><span class="var type1" id="S10T55U925">options</span>.includeOriginalAxes</span></span></span>
<span class="srcline"><span class="lineno"><a href="181,189" id="srcline189">189</a></span><span class="line">        <span class="mxinfo" id="T52:U568"><span class="var type1" id="S5T52U929">projMat</span> = <span class="mxinfo" id="T52:U570">[<span class="var type1" id="S5T52U932">projMat</span>,<span class="mxinfo" id="T52:U572">eye(<span class="mxinfo" id="T4:U573">size(<span class="var type1" id="S5T52U937">projMat</span>,1)</span>)</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="181,190" id="srcline190">190</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="181,191" id="srcline191">191</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="181,192" id="srcline192">192</a></span><span class="line">    <span class="mxinfo" id="T52:U575"><span class="var type1" id="S77T52U941">UTrain</span> = <span class="mxinfo" id="T52:U577"><span class="mxinfo" id="T52:U578"><span class="var type1" id="S8T52U944">XTrain</span>(:,<span class="var type1" id="S7T51U946">iIn</span>)</span>*<span class="var type1" id="S5T52U947">projMat</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="181,193" id="srcline193">193</a></span><span class="line">    <span class="comment">% This step catches splits based on no significant variation</span></span></span>
<span class="srcline"><span class="lineno"><a href="181,194" id="srcline194">194</a></span><span class="line">    <span class="mxinfo" id="T73:U582"><span class="var type1" id="S78T73U950">bUTrainVaries</span> = <span class="mxinfo" id="T73:U584"><span class="fcn" id="F344N9:B952">queryIfColumnsVary</span>(<span class="var type1" id="S77T52U953">UTrain</span>,<span class="mxinfo" id="T4:U586"><span class="var type1" id="S10T55U955">options</span>.XVariationTol</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="181,195" id="srcline195">195</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="181,196" id="srcline196">196</a></span><span class="line">    <span class="keyword">if</span> <span class="mxinfo" id="T6:U588">~<span class="mxinfo" id="T6:U589">any(<span class="var type1" id="S78T73U962">bUTrainVaries</span>)</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="181,197" id="srcline197">197</a></span><span class="line">        <span class="mxinfo" id="T6:U591"><span class="var type1" id="S2T6U965">bLeaf</span> = <span class="mxinfo" id="T6:U593">true</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="181,198" id="srcline198">198</a></span><span class="line">        <span class="mxinfo" id="T4:U594"><span class="var type1" id="S79T4U970">nProjDirs</span> = <span class="mxinfo" id="T4:U596">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="181,199" id="srcline199">199</a></span><span class="line">        <span class="mxinfo" id="T46:U597"><span class="var type1" id="S80T46U974">splitGains</span> = <span class="mxinfo" id="T38:U599"><span class="mxinfo" id="T4:U600">-inf</span>*ones(<span class="var type1" id="S79T4U981">nProjDirs</span>,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="181,200" id="srcline200">200</a></span><span class="line">        <span class="mxinfo" id="T46:U602"><span class="var type1" id="S83T46U985">iSplits</span> = <span class="mxinfo" id="T38:U604">zeros(<span class="mxinfo" id="T4:U605"><span class="var type1" id="S79T4U988">nProjDirs</span></span>,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="181,201" id="srcline201">201</a></span><span class="line">    <span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="181,202" id="srcline202">202</a></span><span class="line">        <span class="mxinfo" id="T52:U607"><span class="var type1" id="S77T52U993">UTrain</span> = <span class="mxinfo" id="T52:U609"><span class="var type1" id="S77T52U995">UTrain</span>(:,<span class="var type1" id="S78T73U997">bUTrainVaries</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="181,203" id="srcline203">203</a></span><span class="line">        <span class="mxinfo" id="T52:U612"><span class="var type1" id="S5T52U1000">projMat</span> = <span class="mxinfo" id="T52:U614"><span class="var type1" id="S5T52U1002">projMat</span>(:,<span class="var type1" id="S78T73U1004">bUTrainVaries</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="181,204" id="srcline204">204</a></span><span class="line">        <span class="mxinfo" id="T4:U617"><span class="var type1" id="S79T4U1007">nProjDirs</span> = <span class="mxinfo" id="T4:U619">size(<span class="var type1" id="S77T52U1010">UTrain</span>,2)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="181,205" id="srcline205">205</a></span><span class="line">        <span class="mxinfo" id="T46:U621"><span class="var type1" id="S80T46U1014">splitGains</span> = <span class="mxinfo" id="T46:U623">NaN(<span class="var type1" id="S79T4U1017">nProjDirs</span>,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="181,206" id="srcline206">206</a></span><span class="line">        <span class="mxinfo" id="T46:U625"><span class="var type1" id="S83T46U1021">iSplits</span> = <span class="mxinfo" id="T46:U627">NaN(<span class="var type1" id="S79T4U1024">nProjDirs</span>,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="181,207" id="srcline207">207</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="181,208" id="srcline208">208</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="181,209" id="srcline209">209</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="181,210" id="srcline210">210</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="181,211" id="srcline211">211</a></span><span class="line">    <span class="comment">%% Search over splits using provided method</span></span></span>
<span class="srcline"><span class="lineno"><a href="181,212" id="srcline212">212</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="181,213" id="srcline213">213</a></span><span class="line">    <span class="keyword">for</span> <span class="var type1" id="S84T4U1028">nVarAtt</span> = <span class="mxinfo" id="T4:U630">1</span>:<span class="var type1" id="S79T4U1031">nProjDirs</span></span></span>
<span class="srcline"><span class="lineno"><a href="181,214" id="srcline214">214</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="181,215" id="srcline215">215</a></span><span class="line">        <span class="comment">% Calculate the probabilities of being at each class in each of child</span></span></span>
<span class="srcline"><span class="lineno"><a href="181,216" id="srcline216">216</a></span><span class="line">        <span class="comment">% nodes based on proportion of training data for each of possible</span></span></span>
<span class="srcline"><span class="lineno"><a href="181,217" id="srcline217">217</a></span><span class="line">        <span class="comment">% splits using current projection</span></span></span>
<span class="srcline"><span class="lineno"><a href="181,218" id="srcline218">218</a></span><span class="line">        <span class="mxinfo" id="T46:U632">[<span class="var type1" id="S85T46U1035">UTrainSort</span>,<span class="var type1" id="S86T46U1036">iUTrainSort</span>] = sort(<span class="mxinfo" id="T46:U635"><span class="var type1" id="S77T52U1040">UTrain</span>(:,<span class="var type1" id="S84T4U1042">nVarAtt</span>)</span>)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="181,219" id="srcline219">219</a></span><span class="line">        <span class="mxinfo" id="T1:U638"><span class="var type1" id="S87T1U1045">YTrainSort</span> = <span class="mxinfo" id="T1:U640"><span class="var type1" id="S9T1U1047">YTrain</span>(<span class="var type1" id="S86T46U1048">iUTrainSort</span>,:)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="181,220" id="srcline220">220</a></span><span class="line">        <span class="keyword">if</span> <span class="mxinfo" id="T6:U643"><span class="mxinfo" id="T4:U644">size(<span class="var type1" id="S9T1U1055">YTrain</span>,2)</span>==<span class="mxinfo" id="T4:U646">1</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="181,221" id="srcline221">221</a></span><span class="line">            <span class="mxinfo" id="T111:U647"><span class="var type1" id="S88T111U1060">LeftCumCounts</span> = <span class="mxinfo" id="T111:U649">[<span class="mxinfo" id="T46:U650"><span class="mxinfo" id="T46:U651">(<span class="mxinfo" id="T51:U652">1:<span class="mxinfo" id="T4:U653">numel(<span class="var type1" id="S87T1U1070">YTrainSort</span>)</span></span>)'</span>-<span class="mxinfo" id="T103:U655">cumsum(<span class="var type1" id="S87T1U1073">YTrainSort</span>)</span></span>,<span class="mxinfo" id="T103:U657">cumsum(<span class="var type1" id="S87T1U1076">YTrainSort</span>)</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="181,222" id="srcline222">222</a></span><span class="line">        <span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="181,223" id="srcline223">223</a></span><span class="line">            <span class="mxinfo" id="T111:U659"><span class="var type1" id="S88T111U1080">LeftCumCounts</span> = <span class="mxinfo" id="T103:U661">cumsum(<span class="var type1" id="S87T1U1083">YTrainSort</span>,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="181,224" id="srcline224">224</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="181,225" id="srcline225">225</a></span><span class="line">        <span class="mxinfo" id="T111:U663"><span class="var type1" id="S90T111U1087">RightCumCounts</span> = <span class="mxinfo" id="T111:U665">bsxfun(@minus,<span class="mxinfo" id="T121:U666"><span class="var type1" id="S88T111U1093">LeftCumCounts</span>(<span class="mxinfo" id="T4:U668">end</span>,:)</span>,<span class="var type1" id="S88T111U1097">LeftCumCounts</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="181,226" id="srcline226">226</a></span><span class="line">        <span class="mxinfo" id="T45:U670"><span class="var type1" id="S92T45U1100">bUniquePoints</span> = <span class="mxinfo" id="T45:U672">[<span class="mxinfo" id="T45:U673"><span class="mxinfo" id="T46:U674">diff(<span class="var type1" id="S85T46U1106">UTrainSort</span>,[],1)</span>&gt;<span class="mxinfo" id="T4:U676"><span class="var type1" id="S10T55U1111">options</span>.XVariationTol</span></span>;<span class="mxinfo" id="T6:U678">false</span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="181,227" id="srcline227">227</a></span><span class="line">        <span class="mxinfo" id="T111:U679"><span class="var type1" id="S94T111U1118">pL</span> = <span class="mxinfo" id="T111:U681">bsxfun(@rdivide,<span class="var type1" id="S88T111U1123">LeftCumCounts</span>,<span class="mxinfo" id="T46:U683">sum(<span class="var type1" id="S88T111U1126">LeftCumCounts</span>,2)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="181,228" id="srcline228">228</a></span><span class="line">        <span class="mxinfo" id="T111:U685"><span class="var type1" id="S95T111U1130">pR</span> = <span class="mxinfo" id="T111:U687">bsxfun(@rdivide,<span class="var type1" id="S90T111U1135">RightCumCounts</span>,<span class="mxinfo" id="T46:U689">sum(<span class="var type1" id="S90T111U1138">RightCumCounts</span>,2)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="181,229" id="srcline229">229</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="181,230" id="srcline230">230</a></span><span class="line">        <span class="comment">% Calculate the metric values of the current node and two child nodes</span></span></span>
<span class="srcline"><span class="lineno"><a href="181,231" id="srcline231">231</a></span><span class="line">        <span class="keyword">if</span> <span class="mxinfo" id="T6:U691">strcmpi(<span class="mxinfo" id="T56:U692"><span class="var type1" id="S10T55U1145">options</span>.splitCriterion</span>,<span class="string">'gini'</span>)</span></span></span>
<span class="srcline"><span class="lineno"><a href="181,232" id="srcline232">232</a></span><span class="line">            <span class="mxinfo" id="T46:U694"><span class="var type1" id="S97T46U1150">metricLeft</span> = <span class="mxinfo" id="T46:U696"><span class="mxinfo" id="T4:U697">1</span>-<span class="mxinfo" id="T46:U698">sum(<span class="mxinfo" id="T52:U699"><span class="var type1" id="S94T111U1156">pL</span>.^2</span>,2)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="181,233" id="srcline233">233</a></span><span class="line">            <span class="mxinfo" id="T46:U701"><span class="var type1" id="S98T46U1161">metricRight</span> = <span class="mxinfo" id="T46:U703"><span class="mxinfo" id="T4:U704">1</span>-<span class="mxinfo" id="T46:U705">sum(<span class="mxinfo" id="T52:U706"><span class="var type1" id="S95T111U1167">pR</span>.^2</span>,2)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="181,234" id="srcline234">234</a></span><span class="line">        <span class="keyword">elseif</span> <span class="mxinfo" id="T6:U708">strcmpi(<span class="mxinfo" id="T56:U709"><span class="var type1" id="S10T55U1174">options</span>.splitCriterion</span>,<span class="string">'info'</span>)</span></span></span>
<span class="srcline"><span class="lineno"><a href="181,235" id="srcline235">235</a></span><span class="line">            <span class="mxinfo" id="T111:U711"><span class="var type1" id="S99T111U1179">pLProd</span> = <span class="mxinfo" id="T111:U713"><span class="var type1" id="S94T111U1181">pL</span>.*<span class="mxinfo" id="T111:U715">log2(<span class="var type1" id="S94T111U1184">pL</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="181,236" id="srcline236">236</a></span><span class="line">            <span class="mxinfo" id="T46:U717"><span class="mxinfo" id="T46:U718"><span class="var type1" id="S99T111U1188">pLProd</span>(<span class="mxinfo" id="T122:U720"><span class="var type1" id="S94T111U1190">pL</span>==<span class="mxinfo" id="T4:U722">0</span></span>)</span> = <span class="mxinfo" id="T4:U723">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="181,237" id="srcline237">237</a></span><span class="line">            <span class="mxinfo" id="T46:U724"><span class="var type1" id="S97T46U1195">metricLeft</span> = <span class="mxinfo" id="T46:U726">-<span class="mxinfo" id="T46:U727">sum(<span class="var type1" id="S99T111U1199">pLProd</span>,2)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="181,238" id="srcline238">238</a></span><span class="line">            <span class="mxinfo" id="T111:U729"><span class="var type1" id="S101T111U1203">pRProd</span> = <span class="mxinfo" id="T111:U731"><span class="var type1" id="S95T111U1205">pR</span>.*<span class="mxinfo" id="T111:U733">log2(<span class="var type1" id="S95T111U1208">pR</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="181,239" id="srcline239">239</a></span><span class="line">            <span class="mxinfo" id="T46:U735"><span class="mxinfo" id="T46:U736"><span class="var type1" id="S101T111U1212">pRProd</span>(<span class="mxinfo" id="T122:U738"><span class="var type1" id="S95T111U1214">pR</span>==<span class="mxinfo" id="T4:U740">0</span></span>)</span> = <span class="mxinfo" id="T4:U741">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="181,240" id="srcline240">240</a></span><span class="line">            <span class="mxinfo" id="T46:U742"><span class="var type1" id="S98T46U1219">metricRight</span> = <span class="mxinfo" id="T46:U744">-<span class="mxinfo" id="T46:U745">sum(<span class="var type1" id="S101T111U1223">pRProd</span>,2)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="181,241" id="srcline241">241</a></span><span class="line">        <span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="181,242" id="srcline242">242</a></span><span class="line">            <span class="mxinfo" id="T46:U747"><span class="var type1" id="S97T46U1228">metricLeft</span> = <span class="mxinfo" id="T46:U749">zeros(<span class="mxinfo" id="T4:U750">size(<span class="var type1" id="S94T111U1233">pL</span>,1)</span>,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="181,243" id="srcline243">243</a></span><span class="line">            <span class="mxinfo" id="T46:U752"><span class="var type1" id="S98T46U1238">metricRight</span> = <span class="mxinfo" id="T46:U754">zeros(<span class="mxinfo" id="T4:U755">size(<span class="var type1" id="S94T111U1243">pL</span>,1)</span>,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="181,244" id="srcline244">244</a></span><span class="line">            error(<span class="string">'Invalid split criterion'</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="181,245" id="srcline245">245</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="181,246" id="srcline246">246</a></span><span class="line">        <span class="mxinfo" id="T4:U757"><span class="var type1" id="S102T4U1252">metricCurrent</span> = <span class="mxinfo" id="T4:U759"><span class="var type1" id="S97T46U1254">metricLeft</span>(<span class="mxinfo" id="T4:U761">end</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="181,247" id="srcline247">247</a></span><span class="line">        <span class="mxinfo" id="T46:U762"><span class="mxinfo" id="T46:U763"><span class="var type1" id="S97T46U1260">metricLeft</span>(<span class="mxinfo" id="T45:U765">~<span class="var type1" id="S92T45U1262">bUniquePoints</span></span>)</span> = <span class="mxinfo" id="T4:U767">inf</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="181,248" id="srcline248">248</a></span><span class="line">        <span class="mxinfo" id="T46:U768"><span class="mxinfo" id="T46:U769"><span class="var type1" id="S98T46U1268">metricRight</span>(<span class="mxinfo" id="T45:U771">~<span class="var type1" id="S92T45U1270">bUniquePoints</span></span>)</span> = <span class="mxinfo" id="T4:U773">inf</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="181,249" id="srcline249">249</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="181,250" id="srcline250">250</a></span><span class="line">        <span class="comment">% Calculate gain in metric for each of possible splits based on current</span></span></span>
<span class="srcline"><span class="lineno"><a href="181,251" id="srcline251">251</a></span><span class="line">        <span class="comment">% metric value minus metric value of child weighted by number of terms</span></span></span>
<span class="srcline"><span class="lineno"><a href="181,252" id="srcline252">252</a></span><span class="line">        <span class="comment">% in each child</span></span></span>
<span class="srcline"><span class="lineno"><a href="181,253" id="srcline253">253</a></span><span class="line">        <span class="mxinfo" id="T46:U774"><span class="var type1" id="S103T46U1275">metricGain</span> = <span class="mxinfo" id="T46:U776"><span class="var type1" id="S102T4U1277">metricCurrent</span>-<span class="mxinfo" id="T46:U778">(<span class="mxinfo" id="T46:U779"><span class="mxinfo" id="T46:U780"><span class="mxinfo" id="T46:U781">(<span class="mxinfo" id="T51:U782">1:<span class="var type1" id="S18T4U1286">N</span></span>)'</span>.*<span class="var type1" id="S97T46U1287">metricLeft</span></span>+<span class="mxinfo" id="T46:U785"><span class="mxinfo" id="T46:U786">(<span class="mxinfo" id="T51:U787"><span class="mxinfo" id="T4:U788"><span class="var type1" id="S18T4U1294">N</span>-<span class="mxinfo" id="T4:U790">1</span></span>:-1:0</span>)'</span>.*<span class="var type1" id="S98T46U1299">metricRight</span></span></span>)/<span class="var type1" id="S18T4U1300">N</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="181,254" id="srcline254">254</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="181,255" id="srcline255">255</a></span><span class="line">        <span class="comment">% Randomly sample from equally best splits</span></span></span>
<span class="srcline"><span class="lineno"><a href="181,256" id="srcline256">256</a></span><span class="line">        <span class="mxinfo" id="T4:U793">[<span class="var type1" id="S80T46U1305">splitGains</span>(<span class="var type1" id="S84T4U1306">nVarAtt</span>),<span class="var type1" id="S83T46U1308">iSplits</span>(<span class="var type1" id="S84T4U1309">nVarAtt</span>)] = max(<span class="mxinfo" id="T46:U798"><span class="var type1" id="S103T46U1313">metricGain</span>(<span class="mxinfo" id="T4:U800">1</span>:<span class="mxinfo" id="T4:U801"><span class="mxinfo" id="T4:U802">end</span>-<span class="mxinfo" id="T4:U803">1</span></span>)</span>)</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="181,257" id="srcline257">257</a></span><span class="line">        <span class="mxinfo" id="T46:U804"><span class="var type1" id="S104T46U1322">iEqualMax</span> = <span class="mxinfo" id="T46:U806">find(<span class="mxinfo" id="T45:U807"><span class="mxinfo" id="T46:U808">abs(<span class="mxinfo" id="T46:U809"><span class="mxinfo" id="T46:U810"><span class="var type1" id="S103T46U1330">metricGain</span>(<span class="mxinfo" id="T4:U812">1</span>:<span class="mxinfo" id="T4:U813"><span class="mxinfo" id="T4:U814">end</span>-<span class="mxinfo" id="T4:U815">1</span></span>)</span>-<span class="mxinfo" id="T4:U816"><span class="var type1" id="S80T46U1338">splitGains</span>(<span class="var type1" id="S84T4U1339">nVarAtt</span>)</span></span>)</span>&lt;(<span class="mxinfo" id="T4:U819"><span class="mxinfo" id="T4:U820">10</span>*<span class="mxinfo" id="T4:U821">eps</span></span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="181,258" id="srcline258">258</a></span><span class="line">        <span class="keyword">if</span> <span class="mxinfo" id="T6:U822">isempty(<span class="var type1" id="S104T46U1349">iEqualMax</span>)</span></span></span>
<span class="srcline"><span class="lineno"><a href="181,259" id="srcline259">259</a></span><span class="line">            <span class="mxinfo" id="T46:U824"><span class="var type1" id="S104T46U1352">iEqualMax</span> = <span class="mxinfo" id="T4:U826">1</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="181,260" id="srcline260">260</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="181,261" id="srcline261">261</a></span><span class="line">        <span class="mxinfo" id="T4:U827"><span class="mxinfo" id="T4:U828"><span class="var type1" id="S83T46U1357">iSplits</span>(<span class="var type1" id="S84T4U1358">nVarAtt</span>)</span> = <span class="mxinfo" id="T4:U831"><span class="var type1" id="S104T46U1360">iEqualMax</span>(<span class="mxinfo" id="T4:U833">randi(<span class="mxinfo" id="T4:U834">numel(<span class="var type1" id="S104T46U1365">iEqualMax</span>)</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="181,262" id="srcline262">262</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="181,263" id="srcline263">263</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="181,264" id="srcline264">264</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="181,265" id="srcline265">265</a></span><span class="line">    <span class="comment">% If no split gives a positive gain then stop</span></span></span>
<span class="srcline"><span class="lineno"><a href="181,266" id="srcline266">266</a></span><span class="line">    <span class="keyword">if</span> <span class="mxinfo" id="T6:U836"><span class="mxinfo" id="T4:U837">max(<span class="var type1" id="S80T46U1371">splitGains</span>)</span>&lt;<span class="mxinfo" id="T4:U839">0</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="181,267" id="srcline267">267</a></span><span class="line">        <span class="mxinfo" id="T6:U840"><span class="var type1" id="S2T6U1375">bLeaf</span> = <span class="mxinfo" id="T6:U842">true</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="181,268" id="srcline268">268</a></span><span class="line">        <span class="mxinfo" id="T107:U843"><span class="var type1" id="S3T107U1380">bLessThanTrain</span> = <span class="mxinfo" id="T66:U845"><span class="mxinfo" id="T6:U846">false</span>(<span class="mxinfo" id="T4:U847">0</span>,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="181,269" id="srcline269">269</a></span><span class="line">        <span class="mxinfo" id="T108:U848"><span class="var type1" id="S4T108U1387">partitionPoint</span> = <span class="mxinfo" id="T4:U850">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="181,270" id="srcline270">270</a></span><span class="line">        <span class="mxinfo" id="T46:U851"><span class="var type1" id="S106T46U1391">phi</span> = <span class="mxinfo" id="T46:U853">zeros(<span class="mxinfo" id="T4:U854">size(<span class="var type1" id="S8T52U1396">XTrain</span>,2)</span>,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="181,271" id="srcline271">271</a></span><span class="line">    <span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="181,272" id="srcline272">272</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="181,273" id="srcline273">273</a></span><span class="line">        <span class="comment">% Establish between projection direction</span></span></span>
<span class="srcline"><span class="lineno"><a href="181,274" id="srcline274">274</a></span><span class="line">        <span class="mxinfo" id="T4:U856"><span class="var type1" id="S107T4U1402">maxGain</span> = <span class="mxinfo" id="T4:U858">max(<span class="var type1" id="S80T46U1405">splitGains</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="181,275" id="srcline275">275</a></span><span class="line">        <span class="mxinfo" id="T46:U860"><span class="var type1" id="S104T46U1408">iEqualMax</span> = <span class="mxinfo" id="T46:U862">find(<span class="mxinfo" id="T45:U863"><span class="mxinfo" id="T46:U864">abs(<span class="mxinfo" id="T46:U865"><span class="var type1" id="S80T46U1415">splitGains</span>-<span class="var type1" id="S107T4U1416">maxGain</span></span>)</span>&lt;(<span class="mxinfo" id="T4:U868"><span class="mxinfo" id="T4:U869">10</span>*<span class="mxinfo" id="T4:U870">eps</span></span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="181,276" id="srcline276">276</a></span><span class="line">        <span class="comment">% Use given method to break ties</span></span></span>
<span class="srcline"><span class="lineno"><a href="181,277" id="srcline277">277</a></span><span class="line">        <span class="keyword">if</span> <span class="mxinfo" id="T6:U871">strcmpi(<span class="mxinfo" id="T56:U872"><span class="var type1" id="S10T55U1427">options</span>.dirIfEqual</span>,<span class="string">'rand'</span>)</span></span></span>
<span class="srcline"><span class="lineno"><a href="181,278" id="srcline278">278</a></span><span class="line">            <span class="mxinfo" id="T4:U874"><span class="var type1" id="S53T4U1432">iDir</span> = <span class="mxinfo" id="T4:U876"><span class="var type1" id="S104T46U1434">iEqualMax</span>(<span class="mxinfo" id="T4:U878">randi(<span class="mxinfo" id="T4:U879">numel(<span class="var type1" id="S104T46U1439">iEqualMax</span>)</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="181,279" id="srcline279">279</a></span><span class="line">        <span class="keyword">elseif</span> <span class="mxinfo" id="T6:U881">strcmpi(<span class="mxinfo" id="T56:U882"><span class="var type1" id="S10T55U1444">options</span>.dirIfEqual</span>,<span class="string">'first'</span>)</span></span></span>
<span class="srcline"><span class="lineno"><a href="181,280" id="srcline280">280</a></span><span class="line">            <span class="mxinfo" id="T4:U884"><span class="var type1" id="S53T4U1449">iDir</span> = <span class="mxinfo" id="T4:U886"><span class="var type1" id="S104T46U1451">iEqualMax</span>(<span class="mxinfo" id="T4:U888">1</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="181,281" id="srcline281">281</a></span><span class="line">        <span class="keyword">else</span></span></span>
<span class="srcline"><span class="lineno"><a href="181,282" id="srcline282">282</a></span><span class="line">            error(<span class="string">'invalid dirIfEqual'</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="181,283" id="srcline283">283</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="181,284" id="srcline284">284</a></span><span class="line">        <span class="mxinfo" id="T4:U889"><span class="var type1" id="S108T4U1460">iSplit</span> = <span class="mxinfo" id="T4:U891"><span class="var type1" id="S83T46U1462">iSplits</span>(<span class="var type1" id="S53T4U1463">iDir</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="181,285" id="srcline285">285</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="181,286" id="srcline286">286</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="181,287" id="srcline287">287</a></span><span class="line">        <span class="comment">%% Establish partition point and assign to child</span></span></span>
<span class="srcline"><span class="lineno"><a href="181,288" id="srcline288">288</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="181,289" id="srcline289">289</a></span><span class="line">        <span class="mxinfo" id="T52:U894"><span class="var type1" id="S5T52U1466">projMat</span>=<span class="mxinfo" id="T46:U896"><span class="var type1" id="S5T52U1468">projMat</span>(:,<span class="mxinfo" id="T4:U898"><span class="var type1" id="S53T4U1471">iDir</span>(1)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="181,290" id="srcline290">290</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="181,291" id="srcline291">291</a></span><span class="line">        <span class="mxinfo" id="T46:U900"><span class="var type1" id="S77T46U1475">UTrain</span> = <span class="mxinfo" id="T46:U902"><span class="var type1" id="S77T52U1477">UTrain</span>(:,<span class="var type1" id="S53T4U1479">iDir</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="181,292" id="srcline292">292</a></span><span class="line">        <span class="mxinfo" id="T46:U905"><span class="var type1" id="S85T46U1482">UTrainSort</span> = <span class="mxinfo" id="T46:U907">sort(<span class="var type1" id="S77T46U1485">UTrain</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="181,293" id="srcline293">293</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="181,294" id="srcline294">294</a></span><span class="line">        <span class="comment">% The convoluted nature of the below is to avoid numerical errors</span></span></span>
<span class="srcline"><span class="lineno"><a href="181,295" id="srcline295">295</a></span><span class="line">        <span class="mxinfo" id="T4:U909"><span class="var type1" id="S109T4U1488">uTrainSortLeftPart</span> = <span class="mxinfo" id="T4:U911"><span class="var type1" id="S85T46U1490">UTrainSort</span>(<span class="var type1" id="S108T4U1491">iSplit</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="181,296" id="srcline296">296</a></span><span class="line">        <span class="mxinfo" id="T46:U914"><span class="var type1" id="S85T46U1494">UTrainSort</span> = <span class="mxinfo" id="T46:U916"><span class="var type1" id="S85T46U1496">UTrainSort</span>-<span class="var type1" id="S109T4U1497">uTrainSortLeftPart</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="181,297" id="srcline297">297</a></span><span class="line">        <span class="mxinfo" id="T4:U919"><span class="var type1" id="S4T4U1500">partitionPoint</span> = <span class="mxinfo" id="T4:U921"><span class="mxinfo" id="T4:U922"><span class="mxinfo" id="T4:U923"><span class="var type1" id="S85T46U1504">UTrainSort</span>(<span class="var type1" id="S108T4U1505">iSplit</span>)</span>*<span class="mxinfo" id="T4:U926">0.5</span></span>+<span class="mxinfo" id="T4:U927"><span class="mxinfo" id="T4:U928"><span class="var type1" id="S85T46U1509">UTrainSort</span>(<span class="mxinfo" id="T4:U930"><span class="var type1" id="S108T4U1511">iSplit</span>+<span class="mxinfo" id="T4:U932">1</span></span>)</span>*<span class="mxinfo" id="T4:U933">0.5</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="181,298" id="srcline298">298</a></span><span class="line">        <span class="mxinfo" id="T108:U934"><span class="var type1" id="S4T108U1516">partitionPoint</span> = <span class="mxinfo" id="T4:U936"><span class="var type1" id="S4T4U1518">partitionPoint</span>+<span class="var type1" id="S109T4U1519">uTrainSortLeftPart</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="181,299" id="srcline299">299</a></span><span class="line">        <span class="mxinfo" id="T46:U939"><span class="var type1" id="S85T46U1522">UTrainSort</span> = <span class="mxinfo" id="T46:U941"><span class="var type1" id="S85T46U1524">UTrainSort</span>+<span class="var type1" id="S109T4U1525">uTrainSortLeftPart</span></span></span>; <span class="comment">%#ok&lt;NASGU&gt;</span></span></span>
<span class="srcline"><span class="lineno"><a href="181,300" id="srcline300">300</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="181,301" id="srcline301">301</a></span><span class="line">        <span class="mxinfo" id="T107:U944"><span class="var type1" id="S3T107U1528">bLessThanTrain</span> = <span class="mxinfo" id="T45:U946"><span class="var type1" id="S77T46U1530">UTrain</span>&lt;=(<span class="mxinfo" id="T118:U948">repmat(<span class="var type1" id="S4T108U1534">partitionPoint</span>,<span class="mxinfo" id="T4:U950">size(<span class="var type1" id="S77T46U1537">UTrain</span>,1)</span>,1)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="181,302" id="srcline302">302</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="181,303" id="srcline303">303</a></span><span class="line">        <span class="keyword">if</span> <span class="mxinfo" id="T6:U952">~<span class="mxinfo" id="T6:U953">any(<span class="mxinfo" id="T45:U954"><span class="var type1" id="S3T107U1547">bLessThanTrain</span>(:)</span>)</span></span> || <span class="mxinfo" id="T6:U956">all(<span class="mxinfo" id="T45:U957"><span class="var type1" id="S3T107U1552">bLessThanTrain</span>(:)</span>)</span></span></span>
<span class="srcline"><span class="lineno"><a href="181,304" id="srcline304">304</a></span><span class="line">            error(<span class="string">'Suggested split with empty'</span>);</span></span>
<span class="srcline"><span class="lineno"><a href="181,305" id="srcline305">305</a></span><span class="line">        <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="181,306" id="srcline306">306</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="181,307" id="srcline307">307</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="181,308" id="srcline308">308</a></span><span class="line">    </span></span>
<span class="srcline"><span class="lineno"><a href="181,309" id="srcline309">309</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="181,310" id="srcline310">310</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="181,311" id="srcline311">311</a></span><span class="line"><span class="mxinfo" id="T46:U959"><span class="var type1" id="S5T46U1560">projMat</span> = <span class="mxinfo" id="T46:U961"><span class="var type1" id="S5T52U1562">projMat</span>(:,<span class="mxinfo" id="T4:U963">1</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="181,312" id="srcline312">312</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="181,313" id="srcline313">313</a></span><span class="line"><span class="keyword">end</span></span></span>
</pre>
