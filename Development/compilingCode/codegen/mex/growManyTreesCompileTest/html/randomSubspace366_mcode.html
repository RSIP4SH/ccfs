<!-- saved from url=(0014)about:internet -->
<pre class="code">
<span class="srcline"><span class="lineno"><a href="81,1" id="srcline1"> 1</a></span><span class="line"><span class="keyword">function</span> <span class="var type1" id="S2T51U3">iIn</span> = randomSubspace(<span class="var type1" id="S3T51U6">iFeatureNum</span>,<span class="var type1" id="S4T4U7">lambda</span>,<span class="var type1" id="S5T4U8">tol</span>,<span class="var type1" id="S6T52U9">XTrain</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="81,2" id="srcline2"> 2</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="81,3" id="srcline3"> 3</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="81,4" id="srcline4"> 4</a></span><span class="line">        <span class="mxinfo" id="T51:U6"><span class="var type1" id="S7T51U12">iCanBeSelected</span> = <span class="mxinfo" id="T51:U8"><span class="fcn" id="F289N4:B14">fastUnique</span>(<span class="var type1" id="S3T51U15">iFeatureNum</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="81,5" id="srcline5"> 5</a></span><span class="line">        <span class="mxinfo" id="T51:U10"><span class="var type1" id="S7T51U19">iCanBeSelected</span>(<span class="mxinfo" id="T73:U12">isnan(<span class="var type1" id="S7T51U22">iCanBeSelected</span>)</span>)=[]</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="81,6" id="srcline6"> 6</a></span><span class="line">        <span class="mxinfo" id="T4:U14"><span class="var type1" id="S4T4U27">lambda</span> = <span class="mxinfo" id="T4:U16">min(<span class="mxinfo" id="T4:U17">numel(<span class="var type1" id="S7T51U32">iCanBeSelected</span>)</span>,<span class="var type1" id="S4T4U33">lambda</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="81,7" id="srcline7"> 7</a></span><span class="line">        <span class="mxinfo" id="T51:U20"><span class="var type1" id="S12T51U36">indFeatIn</span> = <span class="mxinfo" id="T51:U22">randperm(<span class="mxinfo" id="T4:U23">numel(<span class="var type1" id="S7T51U41">iCanBeSelected</span>)</span>,<span class="var type1" id="S4T4U42">lambda</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="81,8" id="srcline8"> 8</a></span><span class="line">        <span class="mxinfo" id="T51:U26"><span class="var type1" id="S14T51U45">iFeatIn</span> = <span class="mxinfo" id="T51:U28"><span class="var type1" id="S7T51U47">iCanBeSelected</span>(<span class="var type1" id="S12T51U48">indFeatIn</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="81,9" id="srcline9"> 9</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="81,10" id="srcline10">10</a></span><span class="line">        <span class="mxinfo" id="T60:U31"><span class="var type1" id="S15T60U51">bInMat</span> = <span class="mxinfo" id="T60:U33">bsxfun(@eq,<span class="mxinfo" id="T51:U34"><span class="mxinfo" id="T46:U35"><span class="var type1" id="S3T51U58">iFeatureNum</span>(:)</span>'</span>,<span class="mxinfo" id="T46:U37">sort(<span class="mxinfo" id="T46:U38"><span class="var type1" id="S14T51U63">iFeatIn</span>(:)</span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="81,11" id="srcline11">11</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="81,12" id="srcline12">12</a></span><span class="line">        <span class="mxinfo" id="T51:U40"><span class="var type1" id="S2T51U67">iIn</span> = <span class="mxinfo" id="T51:U42">find(<span class="mxinfo" id="T73:U43">any(<span class="var type1" id="S15T60U72">bInMat</span>,1)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="81,13" id="srcline13">13</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="81,14" id="srcline14">14</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="81,15" id="srcline15">15</a></span><span class="line">        <span class="comment">% Check for variation along selected dimensions and resample features that</span></span></span>
<span class="srcline"><span class="lineno"><a href="81,16" id="srcline16">16</a></span><span class="line">        <span class="comment">% have no variation</span></span></span>
<span class="srcline"><span class="lineno"><a href="81,17" id="srcline17">17</a></span><span class="line">        </span></span>
<span class="srcline"><span class="lineno"><a href="81,18" id="srcline18">18</a></span><span class="line">        <span class="mxinfo" id="T73:U45"><span class="var type1" id="S21T73U76">bXVaries</span> = <span class="mxinfo" id="T73:U47"><span class="fcn" id="F344N9:B78">queryIfColumnsVary</span>(<span class="mxinfo" id="T52:U48"><span class="var type1" id="S6T52U80">XTrain</span>(:,<span class="var type1" id="S2T51U82">iIn</span>)</span>,<span class="var type1" id="S5T4U83">tol</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="81,19" id="srcline19">19</a></span><span class="line">                </span></span>
<span class="srcline"><span class="lineno"><a href="81,20" id="srcline20">20</a></span><span class="line">        <span class="keyword">if</span> <span class="mxinfo" id="T6:U52">~<span class="mxinfo" id="T6:U53">all(<span class="var type1" id="S21T73U89">bXVaries</span>)</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="81,21" id="srcline21">21</a></span><span class="line">            <span class="mxinfo" id="T51:U55"><span class="var type1" id="S24T51U92">iInNew</span> = <span class="var type1" id="S2T51U93">iIn</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="81,22" id="srcline22">22</a></span><span class="line">            <span class="mxinfo" id="T4:U58"><span class="var type1" id="S25T4U96">nSelected</span> = <span class="mxinfo" id="T4:U60">0</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="81,23" id="srcline23">23</a></span><span class="line">            <span class="mxinfo" id="T51:U61"><span class="var type1" id="S2T51U100">iIn</span> = <span class="mxinfo" id="T51:U63"><span class="var type1" id="S2T51U102">iIn</span>(<span class="var type1" id="S21T73U103">bXVaries</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="81,24" id="srcline24">24</a></span><span class="line">            <span class="keyword">while</span> <span class="mxinfo" id="T6:U66">~<span class="mxinfo" id="T6:U67">all(<span class="var type1" id="S21T73U109">bXVaries</span>)</span></span> &amp;&amp; <span class="mxinfo" id="T6:U69"><span class="var type1" id="S4T4U111">lambda</span>&gt;<span class="mxinfo" id="T4:U71">0</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="81,25" id="srcline25">25</a></span><span class="line">                <span class="mxinfo" id="T51:U72"><span class="mxinfo" id="T51:U73"><span class="var type1" id="S3T51U116">iFeatureNum</span>(<span class="mxinfo" id="T51:U75"><span class="var type1" id="S24T51U118">iInNew</span>(<span class="mxinfo" id="T73:U77">~<span class="var type1" id="S21T73U120">bXVaries</span></span>)</span>)</span> = <span class="mxinfo" id="T4:U79">NaN</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="81,26" id="srcline26">26</a></span><span class="line">                <span class="mxinfo" id="T60:U80"><span class="mxinfo" id="T60:U81"><span class="var type1" id="S15T60U126">bInMat</span>(:,<span class="mxinfo" id="T51:U83"><span class="var type1" id="S24T51U129">iInNew</span>(<span class="mxinfo" id="T73:U85">~<span class="var type1" id="S21T73U131">bXVaries</span></span>)</span>)</span> = <span class="mxinfo" id="T6:U87">false</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="81,27" id="srcline27">27</a></span><span class="line">                <span class="mxinfo" id="T45:U88"><span class="var type1" id="S28T45U136">bRemainsSelected</span> = <span class="mxinfo" id="T45:U90">any(<span class="var type1" id="S15T60U139">bInMat</span>,2)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="81,28" id="srcline28">28</a></span><span class="line">                <span class="mxinfo" id="T4:U92"><span class="var type1" id="S25T4U143">nSelected</span> = <span class="mxinfo" id="T4:U94"><span class="var type1" id="S25T4U145">nSelected</span>+<span class="mxinfo" id="T4:U96">sum(<span class="var type1" id="S28T45U148">bRemainsSelected</span>)</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="81,29" id="srcline29">29</a></span><span class="line">                <span class="mxinfo" id="T51:U98"><span class="var type1" id="S7T51U152">iCanBeSelected</span>(<span class="var type1" id="S12T51U153">indFeatIn</span>) = []</span>;</span></span>
<span class="srcline"><span class="lineno"><a href="81,30" id="srcline30">30</a></span><span class="line">                <span class="mxinfo" id="T4:U101"><span class="var type1" id="S4T4U158">lambda</span> = <span class="mxinfo" id="T4:U103">min(<span class="mxinfo" id="T4:U104">numel(<span class="var type1" id="S7T51U163">iCanBeSelected</span>)</span>,<span class="mxinfo" id="T4:U106"><span class="var type1" id="S4T4U165">lambda</span>-<span class="var type1" id="S25T4U166">nSelected</span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="81,31" id="srcline31">31</a></span><span class="line">                <span class="keyword">if</span> <span class="mxinfo" id="T6:U109"><span class="var type1" id="S4T4U170">lambda</span>&lt;<span class="mxinfo" id="T4:U111">1</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="81,32" id="srcline32">32</a></span><span class="line">                    <span class="keyword">break</span></span></span>
<span class="srcline"><span class="lineno"><a href="81,33" id="srcline33">33</a></span><span class="line">                <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="81,34" id="srcline34">34</a></span><span class="line">                <span class="mxinfo" id="T51:U112"><span class="var type1" id="S12T51U175">indFeatIn</span> = <span class="mxinfo" id="T51:U114">randperm(<span class="mxinfo" id="T4:U115">numel(<span class="var type1" id="S7T51U180">iCanBeSelected</span>)</span>,<span class="var type1" id="S4T4U181">lambda</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="81,35" id="srcline35">35</a></span><span class="line">                <span class="mxinfo" id="T51:U118"><span class="var type1" id="S14T51U184">iFeatIn</span> = <span class="mxinfo" id="T51:U120"><span class="var type1" id="S7T51U186">iCanBeSelected</span>(<span class="var type1" id="S12T51U187">indFeatIn</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="81,36" id="srcline36">36</a></span><span class="line">                <span class="mxinfo" id="T60:U123"><span class="var type1" id="S15T60U190">bInMat</span> = <span class="mxinfo" id="T60:U125">bsxfun(@eq,<span class="mxinfo" id="T51:U126"><span class="mxinfo" id="T46:U127"><span class="var type1" id="S3T51U197">iFeatureNum</span>(:)</span>'</span>,<span class="mxinfo" id="T46:U129"><span class="var type1" id="S14T51U200">iFeatIn</span>(:)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="81,37" id="srcline37">37</a></span><span class="line">                <span class="mxinfo" id="T51:U131"><span class="var type1" id="S24T51U204">iInNew</span> = <span class="mxinfo" id="T51:U133">find(<span class="mxinfo" id="T73:U134">any(<span class="var type1" id="S15T60U209">bInMat</span>,1)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="81,38" id="srcline38">38</a></span><span class="line">                <span class="mxinfo" id="T73:U136"><span class="var type1" id="S21T73U213">bXVaries</span> = <span class="mxinfo" id="T73:U138"><span class="fcn" id="F344N9:B215">queryIfColumnsVary</span>(<span class="mxinfo" id="T52:U139"><span class="var type1" id="S6T52U217">XTrain</span>(:,<span class="var type1" id="S24T51U219">iInNew</span>)</span>,<span class="var type1" id="S5T4U220">tol</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="81,39" id="srcline39">39</a></span><span class="line">                <span class="mxinfo" id="T51:U143"><span class="var type1" id="S2T51U223">iIn</span> = <span class="mxinfo" id="T51:U145">sort(<span class="mxinfo" id="T51:U146">[<span class="var type1" id="S2T51U228">iIn</span>,<span class="mxinfo" id="T51:U148"><span class="var type1" id="S24T51U230">iInNew</span>(<span class="var type1" id="S21T73U231">bXVaries</span>)</span>]</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="81,40" id="srcline40">40</a></span><span class="line">            <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="81,41" id="srcline41">41</a></span><span class="line">        <span class="keyword"><span class="keyword">end</span></span></span></span>
</pre>
